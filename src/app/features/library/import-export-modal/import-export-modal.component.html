<div class="import-export-shell">
  <h2>Import / Export</h2>

  <!-- <div class="row">
    <button class="btn" (click)="backupLibrary()" [disabled]="busy">Backup Full Library</button>
    <small class="muted">Creates a JSON backup containing metadata and file data (base64).</small>
  </div> -->
  <div class="column">
    <label class="file-label nowrap">Restore from backup</label>
    <div class="row">
      <input type="file" accept="application/json" (change)="onFileSelected($event)" />
      <button class="btn" (click)="restoreFromFile()" [disabled]="busy || !selectedFile">Restore</button>
    </div>
  </div>
  

  <!-- Auto-backups section -->
  <div class="auto-backup-section">
    <div class="auto-backup-header">
      <h3>Auto-Backups</h3>
      <button class="btn btn-sm" (click)="createBackupNow()" [disabled]="busy">Backup Now</button>
    </div>
    <small class="muted">The library is automatically backed up every 5 minutes and on edits. Only the latest backup is kept.</small>

    <div *ngIf="loadingBackups" class="spinner">⏳ Loading backups…</div>

    <div *ngIf="!loadingBackups && autoBackups.length === 0" class="no-backups">
      No auto-backups yet. One will be created automatically in a few minutes.
    </div>

    <ul *ngIf="!loadingBackups && autoBackups.length > 0" class="backup-list">
      <li *ngFor="let backup of autoBackups" class="backup-item">
        <div class="backup-info">
          <span class="backup-date">{{ timeAgo(backup.createdAt) }}</span>
          <span class="backup-size">{{ formatSize(backup.size) }}</span>
        </div>
        <div class="backup-actions">
          <button class="btn btn-icon" title="Download" (click)="downloadAutoBackup(backup.id)">⬇</button>
          <button class="btn btn-icon" title="Restore" (click)="restoreAutoBackup(backup.id)" [disabled]="busy">↻</button>
          <button class="btn btn-icon btn-danger" title="Delete" (click)="deleteAutoBackup(backup.id)">✕</button>
        </div>
      </li>
    </ul>
  </div>

  <div class="row status">
    <div *ngIf="busy" class="spinner">⏳</div>
    <div *ngIf="message" class="message">{{ message }}</div>
  </div>

  <div class="row actions">
    <button class="btn btn-secondary" (click)="close()">Close</button>
  </div>
</div>